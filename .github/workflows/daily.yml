name: Daily flight check

on:
  schedule:
    - cron: "0 13 * * *"   # 13:00 UTC â‰ˆ 7am Chicago (CST). Adjust if desired.
  workflow_dispatch:

jobs:
  run:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install requests

      - name: Run flight agent
        env:
          DUFFEL_TOKEN: ${{ secrets.DUFFEL_TOKEN }}
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}

          # Reusable settings (edit these anytime)
          ORIGIN: ORD
          DEST: LHR
          OUTBOUND_CABIN: business
          RETURN_CABIN: premium_economy

          CURRENCY: USD
          THRESHOLD: "3000"

          START_DAYS_OUT: "14"
          END_DAYS_OUT: "28"
          MIN_TRIP_DAYS: "3"
          MAX_TRIP_DAYS: "14"

          PREFER_NONSTOP: "true"
          MAX_STOPS_PREFERRED: "0"
          MAX_STOPS_FALLBACK: "1"
        run: |
          python flight_agent.py
